@let url = kcContext.url;
@let password = kcContext.password;
@let account = kcContext.account;
@let stateChecker = kcContext.stateChecker;

<kc-account-template [active]="'password'">
  <ng-container content>
    <div class="row">
      <div class="col-md-10">
        <h2>{{ 'changePasswordHtmlTitle' | msgStr }}</h2>
      </div>
      <div class="col-md-2 subtitle">
        <span class="subtitle">{{ 'allFieldsRequired' | msgStr }}</span>
      </div>
    </div>

    <form
      [action]="url.passwordUrl"
      class="form-horizontal"
      method="post"
    >
      <input
        type="text"
        id="username"
        name="username"
        [value]="account.username ?? ''"
        autoComplete="username"
        readOnly
        [style.display]="'none'"
      />

      @if (password.passwordSet) {
        <div class="form-group">
          <div class="col-sm-2 col-md-2">
            <label
              for="password"
              class="control-label"
            >
              {{ 'password' | msgStr }}
            </label>
          </div>
          <div class="col-sm-10 col-md-10">
            <input
              type="password"
              class="form-control"
              id="password"
              name="password"
              autoFocus
              autoComplete="current-password"
              [value]="currentPassword()"
              (change)="currentPassword.set($any($event.target).value)"
            />
          </div>
        </div>
      }

      <input
        type="hidden"
        id="stateChecker"
        name="stateChecker"
        [value]="stateChecker"
      />

      <div class="form-group">
        <div class="col-sm-2 col-md-2">
          <label
            for="password-new"
            class="control-label"
          >
            {{ 'passwordNew' | msgStr }}
          </label>
        </div>
        <div class="col-sm-10 col-md-10">
          <input
            type="password"
            class="form-control"
            id="password-new"
            name="password-new"
            autoComplete="new-password"
            [value]="newPassword()"
            (change)="onNewPasswordChange($any($event.target).value)"
            (blur)="onNewPasswordBlur()"
          />
        </div>
      </div>

      <div class="form-group">
        <div class="col-sm-2 col-md-2">
          <label
            for="password-confirm"
            class="control-label two-lines"
          >
            {{ 'passwordConfirm' | msgStr }}
          </label>
        </div>

        <div class="col-sm-10 col-md-10">
          <input
            type="password"
            class="form-control"
            id="password-confirm"
            name="password-confirm"
            autoComplete="new-password"
            [value]="newPasswordConfirm()"
            (change)="onNewPasswordConfirmChange($any($event.target).value)"
            (blur)="onNewPasswordConfirmBlur()"
          />
        </div>
      </div>

      <div class="form-group">
        <div
          id="kc-form-buttons"
          class="col-md-offset-2 col-md-10 submit"
        >
          <div>
            <button
              [disabled]="newPasswordError() !== '' || newPasswordConfirmError() !== ''"
              type="submit"
              [kcClass]="['kcButtonClass', 'kcButtonPrimaryClass', 'kcButtonLargeClass']"
              name="submitAction"
              value="Save"
            >
              {{ 'doSave' | msgStr }}
            </button>
          </div>
        </div>
      </div>
    </form>
  </ng-container>
</kc-account-template>
